---
import Layout from '../../layouts/Layout.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';
import TextProject from '../../components/project-templates/TextProject.astro';
import VisualProject from '../../components/project-templates/VisualProject.astro';
// 2. 生成静态路径
export async function getStaticPaths() {
  // 获取所有 md 文件
  const projects = await getCollection('projects');
  
  return projects.map(entry => ({
    // params.slug 对应文件名 (如 soft-1)
    params: { slug: entry.slug },
    // 将整个文件数据传递给页面
    props: { entry },
  }));
}

const { entry } = Astro.props;
// 3. 渲染 Markdown 正文为 HTML
const { Content } = await entry.render();
// 4. 获取 Frontmatter 数据 (相当于以前的 project 对象)
const projectData = entry.data;
---

<Layout title={projectData.title}>
  {
    projectData.projectType === 'visual' 
    ? (
      // 把数据传给模板，把正文 <Content/> 塞进插槽
      <VisualProject project={projectData}>
        <Content />
      </VisualProject>
    )
    : (
      <TextProject project={projectData}>
        <Content />
      </TextProject>
    )
  }
  
  <div class="container footer-wrapper">
    <Footer />
  </div>
</Layout>

<style>
  .footer-wrapper {
    margin-top: auto;
    padding-bottom: 2rem;
  }
</style>
